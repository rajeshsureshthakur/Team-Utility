String sql = """
            WITH week_data AS (
                SELECT 
                    a.employee_id,
                    TRUNC(a.attendance_date, 'IW') AS week_start,
                    SUM(CASE WHEN a.status = 1 THEN 1 ELSE 0 END) AS present_count
                FROM attendance a
                JOIN users u ON a.employee_id = u.employee_id
                WHERE 
                    u.team_id IN (1, 2, 34)
                    AND a.attendance_date >= TRUNC(SYSDATE, 'IW') - (3 * 7)
                    AND a.attendance_date <= CASE 
                        WHEN TO_CHAR(SYSDATE, 'D') = '2' THEN TRUNC(SYSDATE, 'IW') - 1
                        ELSE TRUNC(SYSDATE, 'IW') + 4
                    END
                GROUP BY a.employee_id, TRUNC(a.attendance_date, 'IW')
            )
            SELECT 
                u.employee_id,
                COALESCE(MAX(CASE WHEN week_start = TRUNC(SYSDATE, 'IW') - (3 * 7) THEN present_count END), 0) AS week_4,
                COALESCE(MAX(CASE WHEN week_start = TRUNC(SYSDATE, 'IW') - (2 * 7) THEN present_count END), 0) AS week_3,
                COALESCE(MAX(CASE WHEN week_start = TRUNC(SYSDATE, 'IW') - (1 * 7) THEN present_count END), 0) AS week_2,
                COALESCE(MAX(CASE WHEN week_start = TRUNC(SYSDATE, 'IW') THEN present_count END), 0) AS week_1
            FROM users u
            LEFT JOIN week_data w ON u.employee_id = w.employee_id
            WHERE u.team_id IN (1, 2, 34)
            GROUP BY u.employee_id
            ORDER BY u.employee_id
            """;
